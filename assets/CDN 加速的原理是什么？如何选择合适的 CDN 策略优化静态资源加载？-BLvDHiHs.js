const n=`### CDN 加速的原理是什么？如何选择合适的 CDN 策略优化静态资源加载？

**答案：**

#### 一、CDN 加速核心原理

CDN（内容分发网络）是部署在全球各地的节点服务器集群，核心是 “**就近访问、缓存静态资源、优化网络路径**”，具体流程：

1. **资源缓存**：将静态资源（JS/CSS/ 图片 / 视频）同步到 CDN 边缘节点（如北京、上海、广州、海外节点）；
2. **请求路由**：用户请求资源时，CDN 调度系统（DNS）将请求路由到**距离用户最近、负载最低**的边缘节点；
3. **资源返回**：边缘节点有缓存则直接返回资源，无缓存则向源站请求并缓存后返回；
4. **优化传输**：CDN 优化网络链路（如 BGP 多线、TCP 优化），减少传输延迟。

#### 二、CDN 核心优势

- 降低网络延迟：就近访问，减少跨地域 / 跨运营商传输；
- 减轻源站压力：边缘节点承接大部分静态资源请求，源站只需处理动态请求；
- 提高可用性：节点故障时自动切换到其他节点；
- 抗流量峰值：分布式节点可承载更高并发（如秒杀、活动页）。

#### 三、选择合适的 CDN 策略优化静态资源

##### 资源分类部署策略

- **静态资源全量上 CDN**：JS/CSS/ 图片 / 字体 / 视频等静态资源全部部署到 CDN，动态接口（API）不走 CDN；
- **按资源类型选节点**：

  - 小文件（JS/CSS/ 小图片）：选择覆盖广、低延迟的节点（如阿里云、腾讯云 CDN）；
  - 大文件（视频 / 安装包）：选择支持大文件分发、带宽充足的节点（如七牛云、又拍云）；
  - 海外资源：选择有海外节点的 CDN（如 Cloudflare、阿里云国际版）。

##### 缓存策略优化

- **设置合理的缓存过期时间**：

  - 不变资源（如第三方库、字体）：设置长缓存（Cache-Control: max-age=31536000，1 年），并使用**文件指纹**（如 \`vue.3.3.4.js\`），更新时修改指纹；
  - 频繁更新资源（如首页 CSS）：设置短缓存（max-age=3600），或启用协商缓存（ETag/Last-Modified）；
- **禁止缓存动态资源**：对接口请求、HTML 文件（CSR 项目除外），设置 \`Cache-Control: no-cache\`；
- **缓存预热**：大促 / 活动前，将核心资源（如活动页图片、JS）主动推送到边缘节点，避免首请求回源。

##### 传输优化策略

- **启用 HTTPS**：CDN 配置 SSL 证书，支持 HTTPS 加速（避免混合内容警告）；
- **开启 Gzip/Brotli 压缩**：CDN 端对 JS/CSS/ 文本文件压缩，减少传输体积；
- **图片 / 视频优化**：使用 CDN 图片处理功能（如动态裁剪、格式转换为 WebP/AVIF），视频开启 HLS/DASH 分片传输；
- **HTTP/2/HTTP/3 支持**：选择支持 HTTP/2/HTTP/3 的 CDN，提升多路复用、头部压缩能力。

##### 域名策略

- **独立域名部署 CDN 资源**：如 \`static.example.com\`，避免主域名 Cookie 随请求发送（减少请求头体积）；
- **多域名拆分资源**：将图片、JS、CSS 分别部署到不同 CDN 域名（如 \`img.example.com\`、\`js.example.com\`），突破浏览器单域名并发限制（HTTP/1.1 下有效，HTTP/2 可忽略）。

##### 监控与回源策略

- **监控节点状态**：实时监控 CDN 节点命中率、延迟、错误率，异常时切换节点；
- **回源策略优化**：边缘节点无缓存时，选择最优路径回源（如同运营商、低延迟），避免回源耗时过长；
- **防盗链配置**：设置 Referer/IP 白名单，防止资源被盗用，减少带宽消耗。`;export{n as default};
