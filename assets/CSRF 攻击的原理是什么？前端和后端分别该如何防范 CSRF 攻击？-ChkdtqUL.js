const e=`## 2. CSRF 攻击的原理是什么？前端和后端分别该如何防范 CSRF 攻击？

### 问题核心

考察跨站请求伪造的攻击逻辑，以及前后端协同防范的核心手段。

### 参考答案

#### （1）攻击原理

CSRF（跨站请求伪造，Cross-Site Request Forgery）：攻击者诱导已登录目标网站的用户，访问恶意网站 / 点击恶意链接，利用用户的合法会话（Cookie），向目标网站发送未授权的请求（如转账、改密码、删数据）。核心是**利用用户的认证状态，冒充用户执行操作**，且请求符合浏览器的同源策略（仅跨站发送请求，不读取响应）。

#### （2）前端防范手段

1. **避免 GET 方法执行敏感操作**：敏感接口（转账、修改信息）仅用 POST/PUT/DELETE 方法，GET 仅用于查询。
2. **请求头添加自定义标识**：如在 AJAX 请求中添加 \`X-Requested-With: XMLHttpRequest\`，后端校验该头（跨站请求无法伪造）。
3. **配合后端传递 CSRF Token**：前端从页面 / 接口获取 Token，请求时通过请求体 / 头携带，后端验证 Token 有效性。
4. **控制第三方链接跳转**：对外部链接添加 \`rel="noopener noreferrer"\`，避免恶意页面获取当前页面上下文。

#### （3）后端防范手段（核心）

1. **CSRF Token 验证**：生成随机且唯一的 Token 绑定用户会话，前端请求必须携带，后端校验 Token 与会话匹配。
2. **验证 Referer/Origin 头**：校验请求的来源域名是否为可信域名（Origin 优先级高于 Referer）。
3. **Cookie SameSite 属性**：设置 Cookie 的 \`SameSite=Lax/Strict\`，限制跨站请求携带 Cookie。
4. **双重验证**：敏感操作（如转账）增加验证码、短信验证等二次校验。`;export{e as default};
