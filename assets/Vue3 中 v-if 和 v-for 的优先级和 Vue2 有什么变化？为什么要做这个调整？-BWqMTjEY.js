const i='### 21. Vue3 中 v-if 和 v-for 的优先级和 Vue2 有什么变化？为什么要做这个调整？\n\n**答**：\n\n#### 优先级变化：\n\n- **Vue2**：`v-for` 优先级高于 `v-if`，即先执行循环，再对每个循环项执行条件判断；\n- **Vue3**：`v-if` 优先级高于 `v-for`，即先执行条件判断，再执行循环（若条件不满足，循环不会执行）。\n\n#### 示例对比：\n\nvue\n\n```\n<!-- Vue2：先循环所有 item，再判断 item.visible -->\n<div v-for="item in list" v-if="item.visible">{{ item.name }}</div>\n\n<!-- Vue3：先判断 list 是否存在（v-if 优先级高），再循环；若 list 为 undefined 会报错 -->\n<div v-for="item in list" v-if="item.visible">{{ item.name }}</div>\n```\n\n#### 调整原因：\n\n1. **避免性能问题**：Vue2 中 `v-for` 优先级更高，即使大部分循环项不满足 `v-if` 条件，也会先创建所有 DOM 节点，再隐藏不满足条件的节点，造成性能浪费；Vue3 调整优先级后，若 `v-if` 条件不满足（如 `list` 为空），`v-for` 不会执行，减少无效渲染。\n2. **避免逻辑歧义**：Vue2 中，`v-for` 内的 `v-if` 无法访问外层的变量（如 `v-for="item in list" v-if="!list.length"` 会失效），因为 `v-for` 优先级高，`list` 已被循环；Vue3 调整后，`v-if` 先执行，可正常访问外层变量，逻辑更清晰。\n3. **强制更合理的代码写法**：Vue3 不推荐在同一元素上混用 `v-for` 和 `v-if`，若需过滤循环项，推荐先通过 computed 过滤数据：\n4. vue\n\n```\n<script setup>\nimport { ref, computed } from \'vue\'\n\nconst list = ref([{ name: \'张三\', visible: true }, { name: \'李四\', visible: false }])\n// 先过滤，再循环\nconst filteredList = computed(() => list.value.filter(item => item.visible))\n<\/script>\n\n<template>\n  <div v-for="item in filteredList">{{ item.name }}</div>\n</template>\n```\n\n#### 注意事项：\n\n- Vue3 中，若同一元素上同时使用 `v-for` 和 `v-if`，`v-if` 无法访问 `v-for` 的循环变量（如 `item`），因为 `v-if` 先执行；\n- 若需基于循环项判断，必须将 `v-if` 移到 `v-for` 的子元素中：\n- vue\n\n```\n<!-- 正确写法 -->\n<div v-for="item in list" :key="item.id">\n  <span v-if="item.visible">{{ item.name }}</span>\n</div>\n```';export{i as default};
